<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/>
      <!--<link rel="stylesheet" type="text/css" href="stylesheets/default.css">-->
      <!--<!--<link href="stylesheets/d.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/fixes.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/main.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/reset.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/print.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/styles.css" rel="stylesheet" type="text/css" />-->
      <!--<link href="stylesheets/style.css" rel="stylesheet" type="text/css" />-->

     <style>
/* Site */
body {
      font-family: Verdana, Lucida Grande, Arial, Helvetica, sans-serif;
      font-size: 16px;
      line-height: 18px;
      padding-top: 10px;
      padding-bottom: 10px;
      background-color: white;
      padding: 30px;
      color: #333;
      border: 1px solid #aaa;
      max-width: 900px;
      margin: 20px auto;	
      background: #fff url(/images/topbluefade.gif) repeat-x center top;	
}

    body > *:first-child {
      margin-top: 0 !important;
    }

    body > *:last-child {
      margin-bottom: 0 !important;
    }

    a {
      color: #4183C4;
      text-decoration: none;
    }

    a.absent {
      color: #cc0000;
    }

    a.anchor {
      display: block;
      padding-left: 30px;
      margin-left: -30px;
      cursor: pointer;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
    }

    h1, h2, h3, h4, h5, h6 {
      margin: 20px 0 10px;
      padding: 0;
      font-weight: bold;
      -webkit-font-smoothing: antialiased;
      cursor: text;
      position: relative;
    }

    h2:first-child, h1:first-child, h1:first-child + h2, h3:first-child, h4:first-child, h5:first-child, h6:first-child {
      margin-top: 0;
      padding-top: 0;
    }

    h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
      text-decoration: none;
    }

    h1 tt, h1 code {
      font-size: inherit;
    }

    h2 tt, h2 code {
      font-size: inherit;
    }

    h3 tt, h3 code {
      font-size: inherit;
    }

    h4 tt, h4 code {
      font-size: inherit;
    }

    h5 tt, h5 code {
      font-size: inherit;
    }

    h6 tt, h6 code {
      font-size: inherit;
    }

    h1 {
      font-size: 28px;
      color: black;
    }

    h2 {
      font-size: 24px;
      border-bottom: 1px solid #cccccc;
      color: black;
    }

    h3 {
      font-size: 18px;
    }

    h4 {
      font-size: 16px;
    }

    h5 {
      font-size: 14px;
    }

    h6 {
      color: #777777;
      font-size: 14px;
    }

    p, blockquote, ul, ol, dl, li, table, pre {
      margin: 3px 0;
    }

    hr {
      background: transparent url("http://tinyurl.com/bq5kskr") repeat-x 0 0;
      border: 0 none;
      color: #cccccc;
      height: 4px;
      padding: 0;
    }

    body > h2:first-child {
      margin-top: 0;
      padding-top: 0;
    }

    body > h1:first-child {
      margin-top: 0;
      padding-top: 0;
    }

    body > h1:first-child + h2 {
      margin-top: 0;
      padding-top: 0;
    }

    body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
      margin-top: 0;
      padding-top: 0;
    }

    a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
      margin-top: 0;
      padding-top: 0;
    }

    h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
      margin-top: 0;
    }

    li p.first {
      display: inline-block;
    }

    ul, ol {
      padding-left: 30px;
    }

    ul :first-child, ol :first-child {
      margin-top: 0;
    }

    ul :last-child, ol :last-child {
      margin-bottom: 0;
    }

    dl {
      padding: 0;
    }

    dl dt {
      font-size: 14px;
      font-weight: bold;
      font-style: italic;
      padding: 0;
      margin: 15px 0 5px;
    }

    dl dt:first-child {
      padding: 0;
    }

    dl dt > :first-child {
      margin-top: 0;
    }

    dl dt > :last-child {
      margin-bottom: 0;
    }

    dl dd {
      margin: 0 0 15px;
      padding: 0 15px;
    }

    dl dd > :first-child {
      margin-top: 0;
    }

    dl dd > :last-child {
      margin-bottom: 0;
    }

    blockquote {
      border-left: 4px solid #dddddd;
      padding: 0 15px;
      color: #777777;
    }

    blockquote > :first-child {
      margin-top: 0;
    }

    blockquote > :last-child {
      margin-bottom: 0;
    }

    table {
      padding: 0;
    }
    table tr {
      border-top: 1px solid #cccccc;
      background-color: white;
      margin: 0;
      padding: 0;
    }

    table tr:nth-child(2n) {
      background-color: #f8f8f8;
    }

    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px;
    }

    table tr td {
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px;
    }

    table tr th :first-child, table tr td :first-child {
      margin-top: 0;
    }

    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0;
    }

    img {
      max-width: 100%;
    }

    span.frame {
      display: block;
      overflow: hidden;
    }

    span.frame > span {
      border: 1px solid #dddddd;
      display: block;
      float: left;
      overflow: hidden;
      margin: 13px 0 0;
      padding: 7px;
      width: auto;
    }

    span.frame span img {
      display: block;
      float: left;
    }

    span.frame span span {
      clear: both;
      color: #333333;
      display: block;
      padding: 5px 0 0;
    }

    span.align-center {
      display: block;
      overflow: hidden;
      clear: both;
    }

    span.align-center > span {
      display: block;
      overflow: hidden;
      margin: 13px auto 0;
      text-align: center;
    }

    span.align-center span img {
      margin: 0 auto;
      text-align: center;
    }

    span.align-right {
      display: block;
      overflow: hidden;
      clear: both;
    }

    span.align-right > span {
      display: block;
      overflow: hidden;
      margin: 13px 0 0;
      text-align: right;
    }

    span.align-right span img {
      margin: 0;
      text-align: right;
    }

    span.float-left {
      display: block;
      margin-right: 13px;
      overflow: hidden;
      float: left;
    }

    span.float-left span {
      margin: 13px 0 0;
    }

    span.float-right {
      display: block;
      margin-left: 13px;
      overflow: hidden;
      float: right;
    }

    span.float-right > span {
      display: block;
      overflow: hidden;
      margin: 13px auto 0;
      text-align: right;
    }

    code, tt {
      font-family: "Lucida Console", "Courier New", courier;
      font-size: 12px;
      margin: 0 2px;
      padding: 3px 5px;
      white-space: nowrap;
      border: 1px solid #eaeaea;
      background-color: #f8f8f8;
      border-radius: 3px;
    }

    pre code {
      margin: 0;
      padding: 0;
      white-space: pre;
      border: none;
      background: transparent;
    }

    .highlight pre {
      background-color: #f8f8f8;
      border: 1px solid #cccccc;
      font-size: 13px;
      line-height: 19px;
      overflow: auto;
      padding: 6px 10px;
      border-radius: 3px;
    }

    pre {
      background-color: #f8f8f8;
      border: 1px solid #cccccc;
      font-size: 13px;
      line-height: 19px;
      overflow: auto;
      padding: 6px 10px;
      border-radius: 3px;
    }

    pre code, pre tt {
      background-color: transparent;
      border: none;
    }

    span.line-numbers {
      margin-right: 10px;
    }

    img.logo {
      display: block;
      margin: 10px auto;
    }

    h1.logo {
      text-align: center;
      font-size: 40px;
    }
a img {
	border: none;
}
a.nohover {
	background-color: transparent !important;
}
a.align-right {
	float: right;
	margin: 0px 0px 0px 10px;
}
a.align-right img {
	display: block;
}
a.align-center {
	display: inline-block;
	margin: 0px 5px;
}
a.align-center img {
	display: block;
}
img.bordered {
	background-color: #fff;
	border: 1px solid #CCC;
	padding: 1px;
}
img.align-right {
	float: right;
	margin: 0px 0px 0px 10px;
}
span.highlight {
	background-color: #ffc;
}
div.section {
	margin: 0px auto;
	overflow: hidden;
	width: 700px;
}
div.section h2 {
	color: #000;
	float: left;
	font-family: Georgia;
	font-size: 28px;
	font-weight: normal;
	line-height: 120%;
	margin: 0px 0px 20px 0px;
	text-align: right;
	width: 200px;
}
div.section h3 {
	color: #900;
	font-family: Georgia;
	font-size: 18px;
	margin: 0px 0px 0px 250px;
	line-height: 140%;
}
div.section h3.pull-left {
	font-size: 20px;
	font-weight: normal;
	line-height: 120%;
	color: #900;
	float: left;
	margin: 0px 0px 10px 0px;
	width: 200px;
	text-align: right;
}
div.section p {
	font-family: Georgia;
	font-size: 18px;
	line-height: 140%;
	margin: 0px 0px 25px 250px;
	width: 450px;
}
div.section h2.small {
	font-size: 20px;
}
div.section p.small {
	font-size: 14px;
}
div.section blockquote {
	margin: 0px 0px 25px 250px;
	width: 450px;
}
div.section blockquote p {
	font-family: Courier New, Courier, mono;
	font-size: 16px;
	font-weight: bold;
	line-height: 140%;
	margin: 0px 25px;
	width: auto;
}
div.section p.more {
	font-size: 12px;
	text-align: center;
}
div.section p.centered {
	text-align: center;
}
div.section p.download,
div.section p.credit {
	font-size: 14px;
}
div.section p.footnote,
div.section p.sponsorship {
	font-size: 12px;
}
div.section img.biopic {
	background-color: #fff;
	border: 2px solid #ccc;
	padding: 2px;
	float: left;
	margin: 0px 0px 10px 40px;
}
div.section a.screencast {
	background-color: transparent !important;
	float: left;
	clear: left;
	margin: 0px 0px 25px 25px;
}
div.section a.screencast img {
	display: block;
	background-color: #fff;
	border: 2px solid #ccc;
	padding: 2px;
}
div.section ul.grid {
	list-style: none;
	margin: 0px 0px 15px 280px;
	padding: 0px;
	overflow: hidden;
	width: 420px;
}
div.section ul.grid li {
	float: left;
	margin: 0px 0px 0px 0px;
	height: 160px;
	width: 200px;
}
div.section ul.grid li a {
	background-color: transparent !important;
	display: block;
	margin: 0px 0px 5px 0px;
}
div.section ul.grid li img {
	display: block;
	border: 1px solid #ccc;
	padding: 1px;
}
div.section ul.grid li p {
	font-size: 10px;
	font-family: inherit;
	margin: 0px;
	width: auto;
}
div.section ul.grid li p a {
	display: inline;
}
div.section ul.grid li p a:hover {
	background-color: #f4dda6 !important;
}
div.section div.video {
	margin: 0px 0px 25px 250px;
	width: 450px;
}
div.section ul.links {
	list-style: none;
	float: left;
	clear: left;
	text-align: right;
	width: 200px;
	padding: 0px;
	margin: 0px 0px 20px 0px;
	font-family: Georgia;
	font-size: 14px;
	line-height: 140%;
	overflow: hidden;
}
div.section ul.links li {
	float: right;
	clear: right;
}
div.section ul.links li.rss {
	background: url(/images/rss.png) no-repeat 0px 1px;
	padding: 0px 0px 0px 22px;
}
div.section code {
	font-family: Courier New, Courier, mono;
	font-size: 16px;
	font-weight: bold;
}
#navigation {
	width: 726px;
	margin: 15px auto 10px;
	font-size: 10px;
	line-height: 12px;
	text-align: center;
}
#navigation a {
	color: #000;
	font-weight: bold;
	font-size: 11px;
	text-decoration: underline;
}
#navigation a:hover {
	background-color: #000;
	color: #fff;
	text-decoration: none;
}
#article {
	padding: 0px 0px 20px 0px;
}
#article header {
	background: url(/images/rails.png) no-repeat left top;
	margin: 50px auto 32px;
	width: 606px;
	padding-left: 100px;
	text-align: center;
}
#article header h1 {
	margin: 0 auto 12px;
  font-family: "expressway",sans-serif;
  font-style: normal;
  font-weight: 700;
	font-size: 38px;
  line-height: 30px;
  color: #000000;
}
#article header h2 {
	margin: 0 auto;
  font-family: "expressway",sans-serif;
  font-style: normal;
  font-weight: 400;
	font-size: 21px;
	line-height: 24px;
	color: #999999;
}
#article p a,
#article ol a,
#article ul a {
	color: #369;
}
#article p a:hover,
#article ol a:hover,
#article ul a:hover {
	background-color: #f4dda6;
	text-decoration: none;
}
#article hr.rule {
	border: 0px;
	color: #bbb;
	background-color: #bbb;
	height: 1px;
	width: 670px;
	margin: 0px auto 25px;
}
#article p.missing {
	color: #000;
	font-family: Georgia;
	font-size: 28px;
	font-weight: normal;
	line-height: 120%;
	margin: 0px auto;
	text-align: center;
	width: 700px;
}
#footer {
	color: #666;
	font-size: 11px;
	margin: 0px auto;
	padding: 0px 0px 44px 0px;
	text-align: center;
	width: 726px;
}
#footer p {
	margin: 12px 0px;
}
#footer p a {
	color: #000;
}
#footer p a:hover {
	background-color: #333;
	color: #fff;
	text-decoration: none;
}
#sponsored_by {
	margin: 17px 0px !important;
}
#sponsored_by a:hover {
	background-color: transparent !important;
}
#sponsored_by a img {
	vertical-align: -7px;
}

/* Overview */
#announce {
	background-color: #981a21;
	color: #fff;
	font-size: 11px;
	line-height: 13px;
	margin: 0px;
	padding: 5px 0px;
	text-align: center;
}
#announce a {
	color: #fff !important;
	text-decoration: underline;
}
#announce a:hover {
	background-color: #000 !important;
	text-decoration: none;
}
#slivers {
	background: url(/images/herobackground.gif) repeat-x left top;
	border-top: 2px solid #F6E69F;
	border-bottom: 2px solid #F6E69F;
	padding: 10px;
}
#slivers ul {
	list-style: none;
	margin: 0px auto;
	padding: 0px;
	overflow: hidden;
	width: 792px;
}
#slivers ul li {
	float: left;
	margin: 0px 24px;
	width: 150px;
}
#slivers ul li h2 {
	color: #0e3062;
	font-family: Georgia;
	font-size: 22px;
	line-height: 24px;
	font-weight: normal;
	margin: 0px 0px 10px 0px;
	text-align: center;
}
#slivers ul li img {
	display: block;
	margin: 0px auto 5px;
}
#slivers ul li p {
	margin: 0px;
	text-align: center;
}
#slivers ul li p a {
	color: #000;
	font-size: 10px;
}
#slivers ul li p a:hover {
	background-color: #000;
	color: #fff;
	text-decoration: none;
}

#slideshow {
	font-family: Georgia;
	font-size: 16px;
	height: 132px;
	line-height: 140%;
	margin: 0px auto 30px;
	text-align: center;
	width: 700px;
	padding: 30px 0px 0px 0px;
	position: relative;
}
#slideshow blockquote {
	margin: 0px;
	position: absolute;
	width: 700px;
}
#slideshow blockquote p {
	margin: 0px;
}
#slideshow blockquote p cite {
	font-size: 14px;
	color: #464242;
}
#slideshow p.more {
	font-size: 14px;
	font-style: italic;
	margin: 0px;
	position: absolute;
	bottom: 0px;
	width: 700px;
}
#slideshow p.more a {
	color: #464242;
}
#slideshow p.more a:hover {
	background-color: #000;
	text-decoration: none;
}
#used_by ul {
	list-style: none;
	margin: 0px 0px 0px 280px;
	padding: 0px;
	overflow: hidden;
}
#used_by ul li {
	float: left;
	margin: 0px 0px 20px 0px;
	width: 209px;
}
#used_by ul li img {
	display: block;
	margin: 0px 0px 5px 0px;
}
#used_by ul li p {
	font-size: 10px;
	font-family: inherit;
	margin: 0px;
	width: auto;
}
/* Applications */
#applications {
	list-style: none;
	margin: 0px auto;
	padding: 0px 0px 0px 110px;
	overflow: hidden;
	width: 700px;
}
#applications li {
	float: left;
	width: 200px;
	margin: 0px 0px 20px 0px;
}
#applications li a {
	display: block;
	margin: 0px 0px 5px 0px;
	background-color: transparent !important;
}
#applications li a img {
	background-color: #fff;
	border: 1px solid #CCC;
	padding: 1px;
	display: block;
}
#applications li p {
	font-size: 10px;
	margin: 0px;
}
#applications li p a {
	display: inline;
}
#applications li p a:hover {
	background-color: #f4dda6 !important;
}
/* Quotes */
#article.quotes blockquote {
	font-family: Georgia;
	font-size: 18px;
	line-height: 140%;
	margin: 0px auto 25px;
	text-align: center;
	width: 700px;
	padding: 0px;
	position: relative;
}
#article.quotes blockquote p {
	margin: 0px;
}
#article.quotes blockquote p cite {
	font-size: 14px;
	color: #a69e8a;
}
/* Security Policy */
#article.security {
	margin: 50px auto 30px;
	width: 700px;
}
#article.security h2 {
	font-weight: bold;
	text-transform: uppercase;
	font-size: 20px;
	font-family: Arial, Helvetica, sans-serif;
	text-align: center;
	margin: 40px 0px 15px 0px;
}
#article.security h3 {
	color: #900;
	font-family: Georgia;
	font-size: 18px;
	margin: 0;
	line-height: 140%;
}
#article.security p,
#article.security ol {
	font-family: Georgia;
	font-size: 18px;
	line-height: 140%;
	margin: 0px 0px 25px 0px;
}
#article.security ol li {
	margin: 0px 0px 10px 0px;
}

     </style>
  </head>
  <body>
    <div id="containter">          
      <h1 id="you-dont-know-js-es6--beyond">You Don’t Know JS: ES6 &amp; Beyond</h1>
<p># Chapter 2: Syntax</p>

<p>If you’ve been writing JS for any length of time, odds are the syntax is pretty familiar to you. There are certainly many quirks, but overall it’s a fairly reasonable and straightforward syntax that draws many similarities from other languages.</p>

<p>However, ES6 adds quite a few new syntactic forms which are going to take some getting used to. In this chapter we’ll take a tour through most of them.</p>

<h2 id="block-scoped-declarations">Block-Scoped Declarations</h2>

<p>You’re probably aware that the fundamental unit of variable scoping in JavaScript has always been the <code>function</code>. If you needed to create a block of scope, the most prevalent way to do so was the IIFE (immediately invoked function expression), such as:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> a = <span style="color:#00D">2</span>;

(<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">IIFE</span>(){
        <span style="color:#080;font-weight:bold">var</span> a = <span style="color:#00D">3</span>;
        console.log( a );        <span style="color:#777">// 3</span>
})();

console.log( a );                <span style="color:#777">// 2</span>
</pre></div>
</div>
</div>

<h3 id="let-declarations"><code>let</code> Declarations</h3>

<p>However, we can now create declarations which are bound to any block, called (unsurprisingly) <em>block scoping</em>. This means all we need is a pair of <code>{ .. }</code> to create a scope. Instead of using <code>var</code>, which always declares variables attached to the enclosing function (or global, if top level) scope, use <code>let</code>:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> a = <span style="color:#00D">2</span>;

{
        let a = <span style="color:#00D">3</span>;
        console.log( a );        <span style="color:#777">// 3</span>
}

console.log( a );                <span style="color:#777">// 2</span>
</pre></div>
</div>
</div>

<p>It’s not very common or idiomatic thus far in JS to use a standalone <code>{ .. }</code> block as shown there, but it’s always been totally valid. And developers from other languages that have <em>block scoping</em> will readily recognize that pattern.</p>

<p>I’m going to suggest that I think this is the far better way to create block-scoped variables, with a dedicated <code>{ .. }</code> block. Moreover, I will also strongly suggest you should always put the <code>let</code> declaration(s) at the very top of that block. If you have more than one to declare, I’d recommend using just one <code>let</code>.</p>

<p>Stylistically, I even prefer to put the <code>let</code> on the same line as the opening <code>{</code>, to make it clearer that this block is only for the purpose of declaring the scope for those variables.</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>{        let a = <span style="color:#00D">2</span>, b, c;
        <span style="color:#777">// ..</span>
}
</pre></div>
</div>
</div>

<p>Now, that’s going to look strange and it’s not likely going to match the recommendations by most other ES6 literature. But I have reasons for my madness.</p>

<p>There’s another proposed form of the <code>let</code> declaration called the <code>let</code>-block, which looks like:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>let (a = <span style="color:#00D">2</span>, b, c) {
        <span style="color:#777">// ..</span>
}
</pre></div>
</div>
</div>

<p>That form is what I’d called <em>explicit</em> block scoping, whereas the <code>let ..</code> declaration form that mirrors <code>var</code> is more <em>implicit</em>, since it kind of hijacks whatever <code>{ .. }</code> pair it’s found in. Generally developers find <em>explicit</em> mechanisms a bit more preferable than <em>implicit</em> mechanisms, and I claim this is one of those cases.</p>

<p>If you compare the previous two snippet forms, they’re very similar, and in my opinion both qualify stylistically as <em>explicit</em> block scoping. Unfortunately, the <code>let (..) { .. }</code> form, the most <em>explicit</em> of the options, was not adopted in ES6. That may be revisited post-ES6, but for now the former option is our best bet, I think.</p>

<p>To reinforce the <em>implicit</em> nature of <code>let ..</code> declarations, consider these usages:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>let a = <span style="color:#00D">2</span>;

<span style="color:#080;font-weight:bold">if</span> (a &gt; <span style="color:#00D">1</span>) {
        let b = a * <span style="color:#00D">3</span>;
        console.log( b );                <span style="color:#777">// 6</span>

        <span style="color:#080;font-weight:bold">for</span> (let i = a; i &lt;= b; i++) {
                let j = i + <span style="color:#00D">10</span>
                console.log( j );
        }
        <span style="color:#777">// 12 13 14 15 16</span>

        let c = a + b;
        console.log( c );                <span style="color:#777">// 8</span>
}
</pre></div>
</div>
</div>

<p>Quick quiz without looking back at that snippet: which variable(s) exist only inside the <code>if</code> statement, and which variable(s) existing only inside the <code>for</code> loop?</p>

<p>The answers: the <code>if</code> statement contains <code>b</code> and <code>c</code> block-scoped variables, and the <code>for</code> loop contains <code>i</code> and <code>j</code> block-scoped variables.</p>

<p>Did you have to think about it for a moment? Does it surprise you that <code>i</code> isn’t added to the enclosing <code>if</code> statement scope? That mental pause and questioning – I call it a “mental tax” – comes from the fact that this <code>let</code> mechanism is not only new to us, but it’s also <em>implicit</em>.</p>

<p>There’s also hazard in the <code>let c = ..</code> declaration appearing so far down in the scope. Unlike traditional <code>var</code>-declared variables, which are attached to the entire enclosing function scope regardless of where they appear, <code>let</code> declarations attach to the block scope but are not initialized until they appear in the block.</p>

<p>Accessing a <code>let</code>-declared variable earlier than its <code>let ..</code> declaration/initialization causes an error, whereas with <code>var</code> declarations the ordering doesn’t matter (except stylistically).</p>

<p>Consider:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>{
        console.log( a );        <span style="color:#777">// undefined</span>
        console.log( b );        <span style="color:#777">// ReferenceError!</span>

        <span style="color:#080;font-weight:bold">var</span> a;
        let b;
}
</pre></div>
</div>
</div>

<p><strong>Warning:</strong> This <code>ReferenceError</code> from accessing too-early <code>let</code>-declared references is technically called a <em>TDZ</em> (temporal dead zone) error – you’re accessing a variable that’s been declared but not yet initialized. This will not be the only time we see <em>TDZ</em> errors – they crop up in several places in ES6. Also, note that “initialized” doesn’t require explicitly assigning a value in your code, as <code>let b;</code> is totally valid. A variable that’s not given an assignment at declaration time is assumed to have been assigned the <code>undefined</code> value, so <code>let b;</code> is the same as <code>let b = undefined;</code>. Explicit assignment or not, you cannot access <code>b</code> until the <code>let b</code> statement is run.</p>

<p>One last gotcha: <code>typeof</code> behaves differently with <em>TDZ</em> variables than it does with undeclared (or declared!) variables.</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>{
        <span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">typeof</span> a === <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">undefined</span><span style="color:#710">&quot;</span></span>) {
                console.log( <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cool</span><span style="color:#710">&quot;</span></span> );
        }

        <span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">typeof</span> b === <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">undefined</span><span style="color:#710">&quot;</span></span>) {                <span style="color:#777">// TypeError!</span>
                <span style="color:#777">// ..</span>
        }

        <span style="color:#777">// ..</span>

        let b;
}
</pre></div>
</div>
</div>

<p>The <code>a</code> is not declared, so <code>typeof</code> is the only safe way to check for its existence or not. But <code>typeof b</code> throws the <em>TDZ</em> error because much farther down in the code there happens to be a <code>let b</code> declaration. Oops.</p>

<p>Now it should be clearer why I strongly prefer – no, I insist – <code>let</code> declarations must all be at the top of the scope. That totally avoids the accidental errors of accessing too early. It also makes it more <em>explicit</em> when you look at the start of a block, any block, what variables it contains.</p>

<p>Your blocks don’t have to share their original behavior with scoping behavior.</p>

<p>This explicitness on your part, which is up to you to maintain with discipline, will save you lots of refactor headaches and footguns down the line.</p>

<p><strong>Note:</strong> For more information on <code>let</code> and block scoping, see Chapter 3 of the <em>“Scope &amp; Closures”</em> title of this series.</p>

<h4 id="let--for"><code>let</code> + <code>for</code></h4>

<p>The only exception I’d make to the preference for the <em>explicit</em> form of <code>let</code> declaration block’ing is a <code>let</code> that appears in the header of a <code>for</code> loop. The reason may seem nuanced, but I consider it to be one of the more important ES6 features.</p>

<p>Consider:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> funcs = [];

<span style="color:#080;font-weight:bold">for</span> (let i = <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">5</span>; i++) {
        funcs.push( <span style="color:#080;font-weight:bold">function</span>(){
                console.log( i );
        } );
}

funcs[<span style="color:#00D">3</span>]();                <span style="color:#777">// 3</span>
</pre></div>
</div>
</div>

<p>The <code>let i</code> in the <code>for</code> header declares an <code>i</code> not just for the <code>for</code> loop itself, but it redeclares a new <code>i</code> for each iteration of the loop. That means that closures created inside the loop iteration close over those per-iteration variables the way you’d expect.</p>

<p>If you tried that same snippet but with <code>var i</code> in the <code>for</code> loop header, you’d get <code>5</code> instead of <code>3</code>, because there’d only be one <code>i</code> in the outer scope that was closed over, instead of a new <code>i</code> for each iteration’s function to close over.</p>

<p>You could also have accomplished the same thing slightly more verbosely:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">var</span> funcs = [];

<span style="color:#080;font-weight:bold">for</span> (<span style="color:#080;font-weight:bold">var</span> i = <span style="color:#00D">0</span>; i &lt; <span style="color:#00D">5</span>; i++) {
        let j = i;
        funcs.push( <span style="color:#080;font-weight:bold">function</span>(){
                console.log( j );
        } );
}

funcs[<span style="color:#00D">3</span>]();                <span style="color:#777">// 3</span>
</pre></div>
</div>
</div>

<p>Here, we forcibly create a new <code>j</code> for each iteration, and then the closure works the same way. I prefer the former approach; that extra special capability is why I endorse the <code>for (let .. ) ..</code> form. It could be argued it’s somewhat more <em>implicit</em>, but it’s <em>explicit</em> enough, and useful enough, for my tastes.</p>

<h3 id="const-declarations"><code>const</code> Declarations</h3>

<p>There’s one other form of block-scoped declaration to consider, the <code>const</code>, which creates <em>constants</em>.</p>

<p>What exactly is a <em>constant</em>? It’s a variable that’s read-only after its initial value is set. Consider:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>{
        const a = <span style="color:#00D">2</span>;
        console.log( a );        <span style="color:#777">// 2</span>

        a = <span style="color:#00D">3</span>;                                <span style="color:#777">// TypeError!</span>
}
</pre></div>
</div>
</div>

<p>You are not allowed to change the value of the variable once it’s been set, at declaration time. A <code>const</code> declaration must have an explicit initialization. If you wanted a <em>constant</em> with the <code>undefined</code> value, you’d have to declare <code>const a = undefined</code> to get it.</p>

<p><em>Constants</em> are not a restriction on the value itself, but on the variable assignment of that value. In other words, the value is not frozen, just the assignment of it. If the value is complex, such as an object or array, the contents of the value can still be modified:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>{
        const a = [<span style="color:#00D">1</span>,<span style="color:#00D">2</span>,<span style="color:#00D">3</span>];
        a.push( <span style="color:#00D">4</span> );
        console.log( a );                <span style="color:#777">// [1,2,3,4]</span>

        a = <span style="color:#00D">42</span>;                                        <span style="color:#777">// TypeError!</span>
}
</pre></div>
</div>
</div>

<p>The <code>a</code> variable doesn’t actually hold a <em>constant</em> array, it holds a <em>constant</em> reference to the array; the array itself is freely mutable.</p>

<p><strong>Warning:</strong> Assigning an object or array as a constant means that value will never be able to be garbage collected, since the reference to the value can never be unset. That may be desirable, but be careful if it’s not your intent!</p>

<p>Essentially, <code>const</code> declarations enforce what we’ve stylistically signaled with our code for years, where we declared a variable name of all uppercase letters and assigned it some literal value that we took care never to change. There’s no enforcement on a <code>var</code> assignment, but there is now with a <code>const</code> assignment, which can help you catch unintended changes.</p>

<p>There’s some rumored assumptions that a <code>const</code> likely will be more optimizable for the JS engine than a <code>let</code> or <code>var</code> would be, since the engine knows the variable will never change so it can eliminate some possible tracking.</p>

<p>Whether that is the case or just our own fantasies and intuitions, the much more important decision to make is if you intend <em>constant</em> behavior or not. Don’t just use <code>const</code> on variables that otherwise don’t obviously appear to be treated as <em>constants</em> in the code, as that will just lead to more confusion.</p>

<h1 id="review">Review</h1>

    </div>
  </body>
</html>
